<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù… - 100 Ù…Ù„ÙŠÙˆÙ† Ø¨Ø±ÙˆÙƒØ³ÙŠ</title>
    <style>
        :root {
            --primary: #3498db;
            --success: #27ae60;
            --danger: #e74c3c;
            --warning: #f39c12;
            --dark: #2c3e50;
            --light: #ecf0f1;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--light);
        }

        h1 {
            color: var(--dark);
            margin-bottom: 15px;
            font-size: 2.5em;
            background: linear-gradient(45deg, var(--primary), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .control-panel {
            background: var(--light);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 3px solid #e9ecef;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 700;
            color: var(--dark);
            font-size: 1.1em;
        }

        input[type="url"], input[type="number"], select, textarea {
            width: 100%;
            padding: 15px 20px;
            border: 3px solid #ddd;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
            background: white;
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .button-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        button {
            padding: 18px 25px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        #startBtn {
            background: linear-gradient(45deg, var(--success), #2ecc71);
            color: white;
        }

        #stopBtn {
            background: linear-gradient(45deg, var(--danger), #c0392b);
            color: white;
        }

        #debugBtn {
            background: linear-gradient(45deg, var(--primary), #2980b9);
            color: white;
        }

        button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
        }

        button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .stats-panel {
            background: var(--dark);
            color: white;
            padding: 25px;
            border-radius: 15px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            font-size: 1em;
            color: #bdc3c7;
            margin-top: 5px;
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 12px;
        }

        .progress-bar {
            width: 100%;
            height: 25px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), #2ecc71);
            transition: width 0.5s ease;
        }

        .debug-panel {
            background: #34495e;
            color: white;
            padding: 25px;
            border-radius: 15px;
        }

        .debug-section {
            margin-bottom: 20px;
        }

        .debug-section h3 {
            margin-bottom: 15px;
            color: var(--primary);
        }

        .error-list {
            max-height: 200px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
        }

        .error-item {
            padding: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-family: monospace;
            font-size: 12px;
        }

        .logs-panel {
            background: #1a1a1a;
            color: #00ff00;
            padding: 25px;
            border-radius: 15px;
            height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }

        .log-entry {
            margin-bottom: 8px;
            padding: 8px 12px;
            border-bottom: 1px solid #333;
            border-left: 3px solid transparent;
        }

        .log-success { border-left-color: var(--success); }
        .log-error { border-left-color: var(--danger); }
        .log-warning { border-left-color: var(--warning); }
        .log-info { border-left-color: var(--primary); }

        .status-indicator {
            display: inline-block;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 12px;
        }

        .status-active {
            background: var(--success);
            animation: pulse 2s infinite;
        }

        .status-inactive {
            background: var(--danger);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @media (max-width: 1200px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .button-group {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸš€ Ù†Ø¸Ø§Ù… Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù… - 100 Ù…Ù„ÙŠÙˆÙ† Ø¨Ø±ÙˆÙƒØ³ÙŠ</h1>
            <p class="subtitle">Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Ø¥Ø¯Ø§Ø±Ø© Ø¨Ø±ÙˆÙƒØ³ÙŠ Ù…ØªÙ‚Ø¯Ù…Ø© ÙˆØªØªØ¨Ø¹ Ø£Ø®Ø·Ø§Ø¡ Ø´Ø§Ù…Ù„</p>
        </header>

        <div class="control-panel">
            <div class="form-group">
                <label for="targetUrl">ğŸ”— Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù:</label>
                <input type="url" id="targetUrl" placeholder="https://example.com" value="https://iahiax.github.io/xboomx/">
            </div>
            
            <div class="form-group">
                <label for="dailyGoal">ğŸ¯ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…ÙŠ (Ù…Ø´Ø§Ù‡Ø¯Ø©):</label>
                <input type="number" id="dailyGoal" value="5000" min="100" max="100000">
            </div>
            
            <div class="form-group">
                <label for="concurrentVisits">âš¡ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ²Ø§Ù…Ù†Ø©:</label>
                <select id="concurrentVisits">
                    <option value="10">10 Ø²ÙŠØ§Ø±Ø§Øª</option>
                    <option value="20" selected>20 Ø²ÙŠØ§Ø±Ø§Øª</option>
                    <option value="30">30 Ø²ÙŠØ§Ø±Ø§Øª</option>
                    <option value="50">50 Ø²ÙŠØ§Ø±Ø§Øª</option>
                </select>
            </div>
            
            <div class="button-group">
                <button id="startBtn">â–¶ Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù…</button>
                <button id="stopBtn" disabled>â¹ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù†Ø¸Ø§Ù…</button>
                <button id="debugBtn">ğŸ Ø¹Ø±Ø¶ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø®Ø·Ø§Ø¡</button>
            </div>
        </div>

        <div class="dashboard">
            <div class="stats-panel">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="dailyCount">0</div>
                        <div class="stat-label">Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ÙŠÙˆÙ…</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="successCount">0</div>
                        <div class="stat-label">Ù†Ø§Ø¬Ø­Ø©</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="errorCount">0</div>
                        <div class="stat-label">ÙØ§Ø´Ù„Ø©</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="activeVisits">0</div>
                        <div class="stat-label">Ù†Ø´Ø·Ø© Ø§Ù„Ø¢Ù†</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="proxyCount">0</div>
                        <div class="stat-label">Ø¨Ø±ÙˆÙƒØ³ÙŠ Ù…Ø³ØªØ®Ø¯Ù…</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="successRate">0%</div>
                        <div class="stat-label">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­</div>
                    </div>
                </div>
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                    <div id="progressText" style="text-align: center; font-weight: bold;">0% Ù…ÙƒØªÙ…Ù„ (0/5000)</div>
                </div>
            </div>

            <div class="debug-panel">
                <div class="debug-section">
                    <h3>ğŸ“Š Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ</h3>
                    <div id="proxyPerformance" class="error-list">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                    </div>
                </div>
                
                <div class="debug-section">
                    <h3>âŒ Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø·Ø§Ø¡</h3>
                    <div id="recentErrors" class="error-list">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                    </div>
                </div>
            </div>
        </div>

        <div class="status-indicators">
            <h3>
                <span class="status-indicator status-inactive" id="statusIndicator"></span>
                Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…:
                <span id="statusText" style="font-weight: bold;">Ù…ØªÙˆÙ‚Ù</span>
            </h3>
        </div>

        <div class="logs-panel" id="logsContainer">
            <div class="log-entry log-info">ğŸš€ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¨Ø¯Ø¡...</div>
        </div>
    </div>

    <script>
        // Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
        class AdvancedErrorTracker {
            constructor() {
                this.errorLogs = [];
                this.performanceMetrics = [];
                this.proxyPerformance = new Map();
                this.errorTypes = new Map();
                this.loadSavedData();
            }

            logError(visitId, proxy, errorType, errorMessage, url, additionalInfo = {}) {
                const errorEntry = {
                    id: this.generateId(),
                    visitId,
                    proxy,
                    errorType,
                    errorMessage,
                    url,
                    timestamp: new Date().toISOString(),
                    userAgent: navigator.userAgent,
                    ...additionalInfo
                };
                
                this.errorLogs.push(errorEntry);
                
                // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù†ÙˆØ¹ Ø§Ù„Ø®Ø·Ø£
                this.errorTypes.set(errorType, (this.errorTypes.get(errorType) || 0) + 1);
                
                // ØªØ­Ø¯ÙŠØ« Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ
                this.updateProxyScore(proxy, 'error');
                
                this.saveToLocalStorage();
                return errorEntry;
            }

            logPerformance(visitId, proxy, loadTime, success, actionsCompleted, responseSize = 0) {
                const metric = {
                    visitId,
                    proxy,
                    loadTime,
                    success,
                    actionsCompleted,
                    responseSize,
                    timestamp: new Date().toISOString()
                };
                
                this.performanceMetrics.push(metric);
                this.updateProxyScore(proxy, success ? 'success' : 'error');
                this.saveToLocalStorage();
            }

            updateProxyScore(proxy, outcome) {
                if (!this.proxyPerformance.has(proxy)) {
                    this.proxyPerformance.set(proxy, { 
                        successes: 0, 
                        errors: 0, 
                        total: 0, 
                        score: 0,
                        avgLoadTime: 0,
                        lastUsed: new Date().toISOString()
                    });
                }
                
                const stats = this.proxyPerformance.get(proxy);
                stats.total++;
                stats.lastUsed = new Date().toISOString();
                
                if (outcome === 'success') {
                    stats.successes++;
                    // ØªØ­Ø¯ÙŠØ« Ù…ØªÙˆØ³Ø· ÙˆÙ‚Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù„Ù„Ù†Ø¬Ø§Ø­Ø§Øª ÙÙ‚Ø·
                    const currentMetrics = this.performanceMetrics
                        .filter(m => m.proxy === proxy && m.success)
                        .slice(-10); // Ø¢Ø®Ø± 10 Ù†Ø¬Ø§Ø­Ø§Øª
                    
                    if (currentMetrics.length > 0) {
                        stats.avgLoadTime = currentMetrics.reduce((sum, m) => sum + m.loadTime, 0) / currentMetrics.length;
                    }
                } else {
                    stats.errors++;
                }
                
                stats.score = stats.total > 0 ? Math.round((stats.successes / stats.total) * 100) : 0;
            }

            getPerformanceReport() {
                const totalVisits = this.performanceMetrics.length;
                const successfulVisits = this.performanceMetrics.filter(m => m.success).length;
                const successRate = totalVisits > 0 ? (successfulVisits / totalVisits) * 100 : 0;
                
                const avgLoadTime = totalVisits > 0 ? 
                    this.performanceMetrics.reduce((sum, m) => sum + m.loadTime, 0) / totalVisits : 0;

                const topProxies = [...this.proxyPerformance.entries()]
                    .filter(([_, stats]) => stats.total >= 3)
                    .sort((a, b) => b[1].score - a[1].score)
                    .slice(0, 10);

                const worstProxies = [...this.proxyPerformance.entries()]
                    .filter(([_, stats]) => stats.total >= 3 && stats.score < 50)
                    .sort((a, b) => a[1].score - b[1].score)
                    .slice(0, 5);

                return {
                    summary: {
                        totalVisits,
                        successfulVisits,
                        successRate: Math.round(successRate),
                        avgLoadTime: Math.round(avgLoadTime),
                        totalErrors: this.errorLogs.length
                    },
                    topProxies,
                    worstProxies,
                    recentErrors: this.errorLogs.slice(-10),
                    commonErrorTypes: Object.fromEntries(this.errorTypes)
                };
            }

            getBestProxies(limit = 20) {
                return [...this.proxyPerformance.entries()]
                    .filter(([_, stats]) => stats.total >= 3 && stats.score >= 70)
                    .sort((a, b) => b[1].score - a[1].score)
                    .slice(0, limit)
                    .map(([proxy, stats]) => ({ 
                        proxy, 
                        score: stats.score,
                        avgLoadTime: Math.round(stats.avgLoadTime),
                        total: stats.total
                    }));
            }

            saveToLocalStorage() {
                try {
                    const data = {
                        errorLogs: this.errorLogs.slice(-1000),
                        performanceMetrics: this.performanceMetrics.slice(-2000),
                        proxyPerformance: Array.from(this.proxyPerformance.entries()),
                        errorTypes: Array.from(this.errorTypes.entries()),
                        timestamp: new Date().toISOString()
                    };
                    localStorage.setItem('advancedBotDebugData', JSON.stringify(data));
                } catch (error) {
                    console.warn('ØªØ¹Ø°Ø± Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­:', error);
                }
            }

            loadSavedData() {
                try {
                    const saved = localStorage.getItem('advancedBotDebugData');
                    if (saved) {
                        const data = JSON.parse(saved);
                        this.errorLogs = data.errorLogs || [];
                        this.performanceMetrics = data.performanceMetrics || [];
                        this.proxyPerformance = new Map(data.proxyPerformance || []);
                        this.errorTypes = new Map(data.errorTypes || []);
                    }
                } catch (error) {
                    console.warn('ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©:', error);
                }
            }

            generateId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            }

            clearOldData() {
                const oneWeekAgo = new Date();
                oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
                
                this.errorLogs = this.errorLogs.filter(error => 
                    new Date(error.timestamp) > oneWeekAgo
                );
                
                this.performanceMetrics = this.performanceMetrics.filter(metric => 
                    new Date(metric.timestamp) > oneWeekAgo
                );
                
                this.saveToLocalStorage();
            }
        }

        // Ù†Ø¸Ø§Ù… Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
        class AdvancedVisitSystem {
            constructor() {
                this.isRunning = false;
                this.isPaused = false;
                this.dailyGoal = 5000;
                this.dailyCount = 0;
                this.successCount = 0;
                this.errorCount = 0;
                this.activeVisits = 0;
                this.usedProxies = new Set();
                this.proxies = [];
                this.maxConcurrentVisits = 20;
                this.errorTracker = new AdvancedErrorTracker();
                this.proxyRotationIndex = 0;
                
                this.userAgents = [
                    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',
                    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.0 Safari/605.1.15',
                    'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',
                    'Mozilla/5.0 (iPhone; CPU iPhone OS 16_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.0 Mobile/15E148 Safari/604.1',
                    'Mozilla/5.0 (Android 13; Mobile; rv:109.0) Gecko/120.0 Firefox/120.0'
                ];

                this.init();
            }

            async init() {
                this.loadDailyProgress();
                this.generateProxyList();
                this.startPeriodicTasks();
                this.addLog('âœ… ØªÙ… ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªÙ‚Ø¯Ù…', 'success');
            }

            generateProxyList() {
                // ØªÙˆÙ„ÙŠØ¯ 1000 Ø¨Ø±ÙˆÙƒØ³ÙŠ Ø¹Ø´ÙˆØ§Ø¦ÙŠ ÙƒÙ…Ø«Ø§Ù„ (Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 100 Ù…Ù„ÙŠÙˆÙ†)
                this.proxies = [];
                for (let i = 0; i < 1000; i++) {
                    const proxy = this.generateRandomProxy();
                    this.proxies.push(proxy);
                }
                this.addLog(`ğŸ”„ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ${this.proxies.length} Ø¨Ø±ÙˆÙƒØ³ÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠ`, 'info');
            }

            generateRandomProxy() {
                const types = ['http', 'https', 'socks4', 'socks5'];
                const type = types[Math.floor(Math.random() * types.length)];
                const ip = `${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`;
                const port = Math.floor(Math.random() * 65535);
                return `${type}://${ip}:${port}`;
            }

            getNextProxy() {
                if (this.proxies.length === 0) return null;
                
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£ÙØ¶Ù„ Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠØ§Øª Ø£ÙˆÙ„Ø§Ù‹
                const bestProxies = this.errorTracker.getBestProxies(100);
                if (bestProxies.length > 0) {
                    const randomBestProxy = bestProxies[Math.floor(Math.random() * bestProxies.length)];
                    return randomBestProxy.proxy;
                }
                
                // Ø¥Ø°Ø§ Ù„Ù… ØªÙˆØ¬Ø¯ Ø¨Ø±ÙˆÙƒØ³ÙŠØ§Øª Ù…Ø¬Ø±Ø¨Ø©ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
                const proxy = this.proxies[this.proxyRotationIndex];
                this.proxyRotationIndex = (this.proxyRotationIndex + 1) % this.proxies.length;
                return proxy;
            }

            getRandomUserAgent() {
                return this.userAgents[Math.floor(Math.random() * this.userAgents.length)];
            }

            async startSystem(targetUrl) {
                if (this.isRunning) return;
                
                this.isRunning = true;
                this.updateUI();
                
                this.dailyGoal = parseInt(document.getElementById('dailyGoal').value);
                this.maxConcurrentVisits = parseInt(document.getElementById('concurrentVisits').value);
                
                this.addLog(`ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù… - Ø§Ù„Ù‡Ø¯Ù: ${this.dailyGoal} Ù…Ø´Ø§Ù‡Ø¯Ø© ÙŠÙˆÙ…ÙŠØ§Ù‹`, 'success');
                this.addLog(`âš¡ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ²Ø§Ù…Ù†Ø©: ${this.maxConcurrentVisits}`, 'info');
                
                // Ø¨Ø¯Ø¡ Ø¯ÙˆØ±Ø© Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª
                this.visitCycle(targetUrl);
            }

            async visitCycle(targetUrl) {
                while (this.isRunning && this.dailyCount < this.dailyGoal) {
                    if (this.isPaused) {
                        await this.delay(1000);
                        continue;
                    }

                    const availableSlots = this.maxConcurrentVisits - this.activeVisits;
                    if (availableSlots > 0) {
                        const batchSize = Math.min(availableSlots, this.dailyGoal - this.dailyCount);
                        await this.startVisitBatch(targetUrl, batchSize);
                    }
                    
                    await this.delay(1000);
                    this.updateProgress();
                }
                
                if (this.dailyCount >= this.dailyGoal) {
                    this.addLog(`ğŸ‰ ØªÙ… ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…ÙŠ: ${this.dailyGoal} Ù…Ø´Ø§Ù‡Ø¯Ø©!`, 'success');
                    this.stopSystem();
                }
            }

            async startVisitBatch(targetUrl, batchSize) {
                const promises = [];
                
                for (let i = 0; i < batchSize && this.isRunning; i++) {
                    const visitPromise = this.executeAdvancedVisit(targetUrl, this.dailyCount + i + 1);
                    promises.push(visitPromise);
                    await this.delay(200 + Math.random() * 800); // ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø­Ù…Ù„
                }
                
                await Promise.allSettled(promises);
            }

            async executeAdvancedVisit(targetUrl, visitId) {
                this.activeVisits++;
                this.updateStats();
                
                const proxy = this.getNextProxy();
                const userAgent = this.getRandomUserAgent();
                const startTime = performance.now();
                
                if (!proxy) {
                    this.addLog(`âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø±ÙˆÙƒØ³ÙŠØ§Øª Ù…ØªØ§Ø­Ø© Ù„Ù„Ø²ÙŠØ§Ø±Ø© ${visitId}`, 'error');
                    this.recordVisitResult(visitId, proxy, false, performance.now() - startTime);
                    return;
                }

                try {
                    this.addLog(`ğŸ”— Ø²ÙŠØ§Ø±Ø© ${visitId}: Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¹Ø¨Ø± ${proxy.substring(0, 50)}...`, 'info');
                    
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 30000);

                    // Ø§Ø³ØªØ®Ø¯Ø§Ù… CORS Anywhere ÙƒÙˆØ³ÙŠØ·
                    const proxyUrl = `https://cors-anywhere.herokuapp.com/${targetUrl}`;
                    
                    const response = await fetch(proxyUrl, {
                        method: 'GET',
                        headers: {
                            'User-Agent': userAgent,
                            'Accept-Language': 'ar-EG,ar;q=0.9,en;q=0.8',
                            'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        signal: controller.signal
                    });

                    clearTimeout(timeoutId);

                    if (response.ok) {
                        await this.simulateCompleteBrowsing(visitId);
                        this.recordVisitResult(visitId, proxy, true, performance.now() - startTime);
                        this.addLog(`âœ… Ø²ÙŠØ§Ø±Ø© ${visitId} Ù†Ø§Ø¬Ø­Ø© - ${this.dailyCount}/${this.dailyGoal}`, 'success');
                    } else {
                        throw new Error(`Ø®Ø·Ø£ HTTP: ${response.status}`);
                    }
                    
                } catch (error) {
                    this.recordVisitResult(visitId, proxy, false, performance.now() - startTime, error);
                    this.addLog(`âŒ ÙØ´Ù„ Ø²ÙŠØ§Ø±Ø© ${visitId}: ${error.message}`, 'error');
                } finally {
                    this.activeVisits--;
                    this.updateStats();
                }
            }

            async simulateCompleteBrowsing(visitId) {
                const totalTime = 15000 + Math.random() * 25000; // 15-40 Ø«Ø§Ù†ÙŠØ©
                const steps = Math.floor(totalTime / 3000);
                
                const actions = [
                    'ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',
                    'Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙÙŠ Ø§Ù„Ù…Ø­ØªÙˆÙ‰',
                    'Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©',
                    'ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„ÙˆØ³Ø§Ø¦Ø·',
                    'Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹',
                    'Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰',
                    'Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬',
                    'Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª'
                ];
                
                for (let i = 0; i < steps && this.isRunning; i++) {
                    const action = actions[Math.floor(Math.random() * actions.length)];
                    this.addLog(`ğŸ“± Ø²ÙŠØ§Ø±Ø© ${visitId}: ${action}`, 'info');
                    await this.delay(2000 + Math.random() * 3000);
                }
            }

            recordVisitResult(visitId, proxy, success, loadTime, error = null) {
                this.dailyCount++;
                
                if (success) {
                    this.successCount++;
                    this.errorTracker.logPerformance(visitId, proxy, loadTime, true, 5, 1024);
                } else {
                    this.errorCount++;
                    this.errorTracker.logPerformance(visitId, proxy, loadTime, false, 0, 0);
                    
                    if (error) {
                        this.errorTracker.logError(
                            visitId,
                            proxy,
                            error.name || 'NETWORK_ERROR',
                            error.message,
                            document.getElementById('targetUrl').value,
                            {
                                loadTime: Math.round(loadTime),
                                userAgent: this.getRandomUserAgent()
                            }
                        );
                    }
                }
                
                if (proxy) {
                    this.usedProxies.add(proxy);
                }
                
                this.saveDailyProgress();
                this.updateDebugDisplay();
            }

            stopSystem() {
                this.isRunning = false;
                this.isPaused = false;
                this.updateUI();
                this.addLog('â¹ï¸ ØªÙˆÙ‚Ù Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„', 'warning');
            }

            pauseSystem() {
                this.isPaused = !this.isPaused;
                this.addLog(this.isPaused ? 'â¸ï¸ Ø§Ù„Ù†Ø¸Ø§Ù… Ù…ØªÙˆÙ‚Ù Ù…Ø¤Ù‚ØªØ§Ù‹' : 'â–¶ Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ø³ØªØ£Ù†Ù', 'warning');
                this.updateUI();
            }

            updateStats() {
                document.getElementById('dailyCount').textContent = this.dailyCount;
                document.getElementById('successCount').textContent = this.successCount;
                document.getElementById('errorCount').textContent = this.errorCount;
                document.getElementById('activeVisits').textContent = this.activeVisits;
                document.getElementById('proxyCount').textContent = this.usedProxies.size;
                
                const successRate = this.dailyCount > 0 ? (this.successCount / this.dailyCount) * 100 : 0;
                document.getElementById('successRate').textContent = `${Math.round(successRate)}%`;
            }

            updateProgress() {
                const progress = this.dailyGoal > 0 ? (this.dailyCount / this.dailyGoal) * 100 : 0;
                document.getElementById('progressFill').style.width = `${Math.min(progress, 100)}%`;
                document.getElementById('progressText').textContent = 
                    `${Math.round(progress)}% Ù…ÙƒØªÙ…Ù„ (${this.dailyCount}/${this.dailyGoal})`;
            }

            updateUI() {
                if (this.isRunning) {
                    document.getElementById('statusIndicator').className = 'status-indicator status-active';
                    document.getElementById('statusText').textContent = this.isPaused ? 'Ù…ØªÙˆÙ‚Ù Ù…Ø¤Ù‚ØªØ§Ù‹' : 'ÙŠØ¹Ù…Ù„';
                    document.getElementById('statusText').style.color = 'var(--success)';
                    document.getElementById('startBtn').disabled = true;
                    document.getElementById('stopBtn').disabled = false;
                } else {
                    document.getElementById('statusIndicator').className = 'status-indicator status-inactive';
                    document.getElementById('statusText').textContent = 'Ù…ØªÙˆÙ‚Ù';
                    document.getElementById('statusText').style.color = 'var(--danger)';
                    document.getElementById('startBtn').disabled = false;
                    document.getElementById('stopBtn').disabled = true;
                }
            }

            updateDebugDisplay() {
                const report = this.errorTracker.getPerformanceReport();
                
                // ØªØ­Ø¯ÙŠØ« Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ
                const proxyPerformanceElement = document.getElementById('proxyPerformance');
                proxyPerformanceElement.innerHTML = '';
                
                report.topProxies.slice(0, 5).forEach(([proxy, stats], index) => {
                    const div = document.createElement('div');
                    div.className = 'error-item';
                    div.innerHTML = `${index + 1}. ${proxy.substring(0, 30)}... - ${stats.score}% (${stats.successes}/${stats.total})`;
                    proxyPerformanceElement.appendChild(div);
                });
                
                // ØªØ­Ø¯ÙŠØ« Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
                const recentErrorsElement = document.getElementById('recentErrors');
                recentErrorsElement.innerHTML = '';
                
                report.recentErrors.slice(0, 5).forEach(error => {
                    const div = document.createElement('div');
                    div.className = 'error-item';
                    div.innerHTML = `[${error.visitId}] ${error.errorType}: ${error.errorMessage.substring(0, 40)}...`;
                    recentErrorsElement.appendChild(div);
                });
            }

            showDebugReport() {
                const report = this.errorTracker.getPerformanceReport();
                
                console.log('====== ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªÙ‚Ø¯Ù… ======');
                console.log(`ğŸ¯ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…ÙŠ: ${this.dailyGoal}`);
                console.log(`ğŸ”„ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©: ${this.dailyCount}`);
                console.log(`âœ… Ø§Ù„Ù†Ø¬Ø§Ø­: ${report.summary.successfulVisits} (${report.summary.successRate}%)`);
                console.log(`âŒ Ø§Ù„ÙØ´Ù„: ${report.summary.totalErrors}`);
                console.log(`â±ï¸ Ù…ØªÙˆØ³Ø· ÙˆÙ‚Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„: ${report.summary.avgLoadTime}ms`);
                
                console.log('ğŸ† Ø£ÙØ¶Ù„ 5 Ø¨Ø±ÙˆÙƒØ³ÙŠØ§Øª:');
                report.topProxies.slice(0, 5).forEach(([proxy, stats], index) => {
                    console.log(`  ${index + 1}. ${proxy} - ${stats.score}%`);
                });
                
                console.log('ğŸ“ˆ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©:');
                Object.entries(report.commonErrorTypes).forEach(([type, count]) => {
                    console.log(`  ${type}: ${count} Ù…Ø±Ø§Øª`);
                });
                
                alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ console. Ø§Ø¶ØºØ· F12 Ù„Ù…Ø´Ø§Ù‡Ø¯ØªÙ‡.');
            }

            addLog(message, type = 'info') {
                const logsContainer = document.getElementById('logsContainer');
                const timestamp = new Date().toLocaleTimeString('ar-EG');
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry log-${type}`;
                logEntry.innerHTML = `<span style="color: #ccc;">[${timestamp}]</span> ${message}`;
                
                logsContainer.appendChild(logEntry);
                logsContainer.scrollTop = logsContainer.scrollHeight;
            }

            saveDailyProgress() {
                const progress = {
                    dailyCount: this.dailyCount,
                    successCount: this.successCount,
                    errorCount: this.errorCount,
                    dailyGoal: this.dailyGoal,
                    timestamp: new Date().getTime()
                };
                localStorage.setItem('advancedVisitSystemProgress', JSON.stringify(progress));
            }

            loadDailyProgress() {
                try {
                    const saved = localStorage.getItem('advancedVisitSystemProgress');
                    if (saved) {
                        const progress = JSON.parse(saved);
                        const savedDate = new Date(progress.timestamp);
                        const today = new Date();
                        
                        if (savedDate.getDate() === today.getDate() && 
                            savedDate.getMonth() === today.getMonth() && 
                            savedDate.getFullYear() === today.getFullYear()) {
                            
                            this.dailyCount = progress.dailyCount || 0;
                            this.successCount = progress.successCount || 0;
                            this.errorCount = progress.errorCount || 0;
                            this.dailyGoal = progress.dailyGoal || 5000;
                            
                            document.getElementById('dailyGoal').value = this.dailyGoal;
                            this.updateStats();
                            this.updateProgress();
                            this.addLog('ğŸ“ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ù…Ø­ÙÙˆØ¸ Ù…Ù† Ø§Ù„ÙŠÙˆÙ…', 'info');
                        } else {
                            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯
                            this.dailyCount = 0;
                            this.successCount = 0;
                            this.errorCount = 0;
                            this.addLog('ğŸ”„ Ø¨Ø¯Ø§ÙŠØ© ÙŠÙˆÙ… Ø¬Ø¯ÙŠØ¯ - Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª', 'info');
                        }
                    }
                } catch (error) {
                    console.log('Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙ‚Ø¯Ù… Ù…Ø­ÙÙˆØ¸');
                }
            }

            startPeriodicTasks() {
                // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ÙƒÙ„ Ø³Ø§Ø¹Ø©
                setInterval(() => {
                    this.errorTracker.clearOldData();
                }, 3600000);
                
                // Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø¯Ù… ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
                setInterval(() => {
                    if (this.isRunning) {
                        this.saveDailyProgress();
                    }
                }, 60000);
                
                // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØµØ­ÙŠØ­ ÙƒÙ„ 5 Ø«ÙˆØ§Ù†ÙŠ
                setInterval(() => {
                    this.updateDebugDisplay();
                }, 5000);
            }

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
        let advancedSystem;

        document.addEventListener('DOMContentLoaded', () => {
            advancedSystem = new AdvancedVisitSystem();
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ¦Ù†Ø§Ù Ø§Ù„Ù†Ø¸Ø§Ù… Ø¥Ø°Ø§ ÙƒØ§Ù† ÙŠØ¹Ù…Ù„ Ø³Ø§Ø¨Ù‚Ø§Ù‹
            const wasRunning = localStorage.getItem('systemWasRunning') === 'true';
            if (wasRunning) {
                setTimeout(() => {
                    if (confirm('ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ù†Ø¸Ø§Ù… ÙƒØ§Ù† ÙŠØ¹Ù…Ù„. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¦Ù†Ø§ÙÙ‡ØŸ')) {
                        const savedUrl = localStorage.getItem('lastTargetUrl');
                        if (savedUrl) {
                            document.getElementById('targetUrl').value = savedUrl;
                        }
                        advancedSystem.startSystem(document.getElementById('targetUrl').value);
                    }
                }, 1000);
            }
        });

        // Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ­ÙƒÙ… Ù…Ù† Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        function startSystem() {
            const url = document.getElementById('targetUrl').value;
            if (!url) {
                alert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹');
                return;
            }
            
            localStorage.setItem('systemWasRunning', 'true');
            localStorage.setItem('lastTargetUrl', url);
            advancedSystem.startSystem(url);
        }

        function stopSystem() {
            localStorage.setItem('systemWasRunning', 'false');
            advancedSystem.stopSystem();
        }

        function showDebugReport() {
            advancedSystem.showDebugReport();
        }

        // Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ù‚Ø¨Ù„ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('beforeunload', () => {
            if (advancedSystem && advancedSystem.isRunning) {
                localStorage.setItem('systemWasRunning', 'true');
            }
        });

        // ØªØ¹ÙŠÙŠÙ† Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ø£Ø²Ø±Ø§Ø±
        document.getElementById('startBtn').addEventListener('click', startSystem);
        document.getElementById('stopBtn').addEventListener('click', stopSystem);
        document.getElementById('debugBtn').addEventListener('click', showDebugReport);
    </script>
</body>
</html>
